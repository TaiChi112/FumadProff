---
title: Data Mining Exercise 6
description: Data Preprocessing & Decision Tree - ‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Entropy ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Node
---

<Callout title="Warning" type="warning">
This article is a work in progress and may contain incomplete information or inaccuracies. Please verify details from reliable sources.
</Callout>

# Data Mining Exercise 6

‡∏£‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á **Data Preprocessing** (‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á) ‡πÅ‡∏•‡∏∞ **Decision Tree Model** (‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Entropy ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Node)

---

## ‡∏Ç‡πâ‡∏≠ 3: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏° 2 ‡πÅ‡∏ö‡∏ö (Stratified vs. Simple Random)

### ‡πÇ‡∏à‡∏ó‡∏¢‡πå

‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á $n$ ‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡πà‡∏≠‡∏¢ $k$ ‡∏Å‡∏•‡∏∏‡πà‡∏°

- **‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1:** Stratified Sampling (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô)
- **‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2:** Simple Random Sampling (‡∏™‡∏∏‡πà‡∏°‡∏£‡∏ß‡∏° ‡πÑ‡∏°‡πà‡∏™‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°)

### ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á (Difference)

‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà **"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°"** ‡πÅ‡∏•‡∏∞ **"‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ (Precision)"**

#### 1. ‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏±‡∏ô‡∏ï‡∏µ‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô (Representation Guarantee)

**‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1 (Stratified):**
- ‡∏Å‡∏≤‡∏£‡∏±‡∏ô‡∏ï‡∏µ 100% ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° $k$ ‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏£‡∏¥‡∏á
- ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏≤ **Imbalanced** (‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÜ ‡∏≠‡∏¢‡∏π‡πà)

<Callout title="üìå ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏ô‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢" type="info">
‡∏°‡∏µ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 9,000 ‡∏Ñ‡∏ô ‡πÅ‡∏•‡∏∞ ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå 100 ‡∏Ñ‡∏ô

‡∏ñ‡πâ‡∏≤‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö **Stratified** ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏¢‡∏¥‡∏ö‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢
</Callout>

**‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2 (Simple Random):**
- ‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏î‡∏ß‡∏á ‡∏ñ‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° $k$ ‡πÑ‡∏´‡∏ô‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞ **"‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÄ‡∏•‡∏¢"**
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏±‡πâ‡∏ô‡∏´‡∏≤‡∏¢‡πÑ‡∏õ (Under-represented)

<Callout title="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á Simple Random" type="warn">
‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏™‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ ‡∏ñ‡πâ‡∏≤‡∏™‡∏∏‡πà‡∏°‡∏£‡∏ß‡∏°‡πÜ ‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡πâ‡∏ß‡∏ô‡πÜ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÄ‡∏•‡∏¢ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô
</Callout>

#### 2. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô (Standard Error)

| ‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏∏‡πà‡∏° | ‡∏Ñ‡πà‡∏≤ Error | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• |
|---------|----------|--------|
| **Stratified** | ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ | ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏∞‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ |
| **Simple Random** | ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ | ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å |

### ‡∏™‡∏£‡∏∏‡∏õ

<Callout title="‚úÖ ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥" type="success">
‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÜ ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ **Stratified**

(‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ Standard ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á Train/Test set ‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô Classification ‡∏î‡πâ‡∏ß‡∏¢)
</Callout>

![Stratified Sampling Diagram](/image/licensed-image.jpg)

---

## ‡∏Ç‡πâ‡∏≠ 4: ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Entropy (‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô)

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏£‡∏ß‡∏° 8 ‡∏•‡∏π‡∏Å:
- üî¥ ‡πÅ‡∏î‡∏á: 4 ‡∏•‡∏π‡∏Å
- üü¢ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß: 2 ‡∏•‡∏π‡∏Å
- üîµ ‡∏ü‡πâ‡∏≤: 2 ‡∏•‡∏π‡∏Å

### ‡∏™‡∏π‡∏ï‡∏£ Entropy:

$$H(X) = - \sum_{i=1}^{n} p(x_i) \log_2 p(x_i)$$

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì

#### 1. ‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô ($p$) ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏µ

$$
P(\text{Red}) = \frac{4}{8} = 0.5
$$
$$
P(\text{Green}) = \frac{2}{8} = 0.25
$$
$$
P(\text{Blue}) = \frac{2}{8} = 0.25
$$

#### 2. ‡πÅ‡∏ó‡∏ô‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡πÉ‡∏ô‡∏™‡∏π‡∏ï‡∏£

‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î‡∏ó‡∏µ‡∏•‡∏∞‡πÄ‡∏ó‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô (‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏ö‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î):

$$
H(X) = - [ (0.5 \log_2 0.5) + (0.25 \log_2 0.25) + (0.25 \log_2 0.25) ]
$$

#### 3. ‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤ Log (‡∏ê‡∏≤‡∏ô 2):
$$
\log_2(0.5) = \log_2(2^{-1}) = -1
$$
$$
\log_2(0.25) = \log_2(2^{-2}) = -2
$$

#### 4. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç

$$
\begin{aligned}
\text{Term Red} &= 0.5 \times (-1) = -0.5 \\
\text{Term Green} &= 0.25 \times (-2) = -0.5 \\
\text{Term Blue} &= 0.25 \times (-2) = -0.5
\end{aligned}
$$

$$
\begin{aligned}
\text{Sum inside bracket} &= -0.5 + (-0.5) + (-0.5) = -1.5 \\
H(X) &= - (-1.5) \\
H(X) &= \mathbf{1.5} \text{ bits}
\end{aligned}
$$

### ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö

<Callout title="‚úÖ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå" type="success">
‡∏Ñ‡πà‡∏≤ Entropy ‡∏Ñ‡∏∑‡∏≠ **1.5 bits**
</Callout>

---

## ‡πÄ‡∏Å‡∏£‡πá‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á Data Mining

### ‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ (Max Entropy) ‡∏Ç‡∏≠‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?

‡∏ñ‡πâ‡∏≤‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏• 3 ‡∏™‡∏µ ‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πä‡∏∞ (‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏´‡∏°‡∏î) ‡∏Ñ‡πà‡∏≤ Entropy ‡∏à‡∏∞‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ $\log_2(3) \approx 1.585$ bits

<Callout title="üí° ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå" type="info">
‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ **1.5** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÄ‡∏ï‡πá‡∏° Max ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ **"‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏™‡∏π‡∏á"** (‡πÄ‡∏î‡∏≤‡∏¢‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏´‡∏¢‡∏¥‡∏ö‡πÑ‡∏î‡πâ‡∏™‡∏µ‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏°‡πâ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏à‡∏∞‡πÄ‡∏¢‡∏≠‡∏∞‡∏™‡∏∏‡∏î‡∏Å‡πá‡∏ï‡∏≤‡∏°)
</Callout>

### ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏±‡∏ö Decision Tree

**‡πÉ‡∏ô Decision Tree:**
- ‡πÄ‡∏£‡∏≤‡∏ä‡∏≠‡∏ö Node ‡∏ó‡∏µ‡πà‡∏°‡∏µ **Entropy ‡∏ï‡πà‡∏≥‡πÜ** (‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏•‡πâ‡∏ß‡∏ô = Entropy 0)
- ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå (Pure)**
- ‡∏¢‡∏¥‡πà‡∏á Pure ‡∏¢‡∏¥‡πà‡∏á‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥!

<a href="https://github.com/TaiChi112/FumadProff/blob/main/content/docs/Computer_Science/DM/Exercies/6.mdx" target="_blank" className="editLink_e1cfa">üìù Edit this page on GitHub</a>